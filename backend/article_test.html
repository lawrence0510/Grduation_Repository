<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>文章檢查</title>
    <style>
        .highlight {
            color: red;
            font-weight: bold;
            font-size: 2em;
        }
        textarea {
            width: 100%;
            height: 100px;
        }
    </style>
</head>
<body>
    <h1 class="highlight">文章 ID: <span id="articleId"></span></h1>
    <h2>標題: <textarea id="title" style="height: 30px;"></textarea></h2>
    <p>內文: <br><textarea id="content" style="height: 800px;"></textarea></p>

    <h3>問題 1</h3>
    <p>問題: <textarea id="question1" style="height: 30px;"></textarea></p>
    <p>選項 A: <textarea id="choice1_1" style="height: 30px;"></textarea></p>
    <p>選項 B: <textarea id="choice1_2" style="height: 30px;"></textarea></p>
    <p>選項 C: <textarea id="choice1_3" style="height: 30px;"></textarea></p>
    <p>選項 D: <textarea id="choice1_4" style="height: 30px;"></textarea></p>
    <p>答案: <textarea id="answer1" style="height: 30px;"></textarea></p>
    <p>詳解: <textarea id="explanation1"></textarea></p>

    <h3>問題 2</h3>
    <p>問題: <textarea id="question2" style="height: 30px;"></textarea></p>
    <p>選項 A: <textarea id="choice2_1" style="height: 30px;"></textarea></p>
    <p>選項 B: <textarea id="choice2_2" style="height: 30px;"></textarea></p>
    <p>選項 C: <textarea id="choice2_3" style="height: 30px;"></textarea></p>
    <p>選項 D: <textarea id="choice2_4" style="height: 30px;"></textarea></p>
    <p>答案: <textarea id="answer2" style="height: 30px;"></textarea></p>
    <p>詳解: <textarea id="explanation2"></textarea></p>

    <h3>問題 3</h3>
    <p>問題: <textarea id="question3" style="height: 30px;"></textarea></p>
    <p>參考答案: <textarea id="answer3"></textarea></p>

    <form id="articleForm">
        <textarea name="article_note" placeholder="有問題或是要修正什麼請在這留言，沒有即留空"></textarea>
        <br>
        <input type="radio" id="pass" name="article_pass" value="1">
        <label for="pass">Pass</label>
        <input type="radio" id="fail" name="article_pass" value="0">
        <label for="fail">Fail</label>
        <br>
        <input type="hidden" name="article_id" id="article_id">
        <button type="submit">送出</button>
    </form>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const endpoint = 'http://nccumisreading.ddnsking.com:5001/Article/get_random_uncheck_article';

            fetch(endpoint)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('articleId').textContent = data.article_id;
                    document.getElementById('title').value = data.article_title;
                    document.getElementById('content').value = data.article_content;
                    document.getElementById('question1').value = data.question_1;
                    document.getElementById('question2').value = data.question_2;
                    document.getElementById('choice1_1').value = data.question1_choice1;
                    document.getElementById('choice1_2').value = data.question1_choice2;
                    document.getElementById('choice1_3').value = data.question1_choice3;
                    document.getElementById('choice1_4').value = data.question1_choice4;
                    document.getElementById('answer1').value = data.question1_answer;
                    document.getElementById('explanation1').value = data.question1_explanation;

                    document.getElementById('choice2_1').value = data.question2_choice1;
                    document.getElementById('choice2_2').value = data.question2_choice2;
                    document.getElementById('choice2_3').value = data.question2_choice3;
                    document.getElementById('choice2_4').value = data.question2_choice4;
                    document.getElementById('answer2').value = data.question2_answer;
                    document.getElementById('explanation2').value = data.question2_explanation;
                    document.getElementById('question3').value = data.question3;
                    document.getElementById('answer3').value = data.question3_answer;
                    document.getElementById('article_id').value = data.article_id;
                });

                document.getElementById('articleForm').onsubmit = function(event) {
    event.preventDefault();

    // 構建提交數據的JSON對象
    const formData = {
        article_title: document.getElementById('title').value,
        article_content: document.getElementById('content').value,
        question_1: document.getElementById('question1').value,
        question_2: document.getElementById('question2').value,
        question1_choice1: document.getElementById('choice1_1').value,
        question1_choice2: document.getElementById('choice1_2').value,
        question1_choice3: document.getElementById('choice1_3').value,
        question1_choice4: document.getElementById('choice1_4').value,
        question1_answer: document.getElementById('answer1').value,
        question1_explanation: document.getElementById('explanation1').value,
        question2_choice1: document.getElementById('choice2_1').value,
        question2_choice2: document.getElementById('choice2_2').value,
        question2_choice3: document.getElementById('choice2_3').value,
        question2_choice4: document.getElementById('choice2_4').value,
        question2_answer: document.getElementById('answer2').value,
        question2_explanation: document.getElementById('explanation2').value,
        question3: document.getElementById('question3').value,
        question3_answer: document.getElementById('answer3').value,
        article_pass: document.querySelector('input[name="article_pass"]:checked').value,
        article_note: document.querySelector('textarea[name="article_note"]').value,
        article_id: document.getElementById('article_id').value
    };
    console.log(formData)

    // 發送請求
    fetch('http://nccumisreading.ddnsking.com:5001/Article/submit_article_note', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('提交成功');
            window.location.reload();
        } else {
            alert('提交失敗');
        }
    })
    .catch(error => console.error('Error:', error));
}

        });
    </script>
</body>
</html>
